# Cloudflare Pages 部署後驗證和測試指南

## 📋 目錄

1. [部署完成檢查](#部署完成檢查)
2. [功能測試](#功能測試)
3. [性能測試](#性能測試)
4. [安全檢查](#安全檢查)
5. [監控和維護](#監控和維護)
6. [故障排除](#故障排除)

---

## 部署完成檢查

### 1.1 驗證部署狀態

#### 在 Cloudflare Dashboard 中

1. 訪問 `https://dash.cloudflare.com`
2. 登入您的 Cloudflare 帳號
3. 點擊「Pages」
4. 選擇 `chunan-victory-church` 項目
5. 點擊「Deployments」標籤

#### 檢查以下信息

| 檢查項 | 預期結果 | 說明 |
|--------|---------|------|
| **Deployment Status** | `Success` | 部署應該成功完成 |
| **Build Status** | `✓ Passed` | 構建應該通過 |
| **Deployment Time** | 2-5 分鐘 | 正常部署時間 |
| **Commit** | 最新的 Git commit | 應該是最新的提交 |

### 1.2 驗證網站可訪問

#### 使用臨時域名

1. 訪問 `https://chunan-victory-church.pages.dev`
2. 等待頁面加載（通常 5-10 秒）
3. 確認看到首頁內容

#### 使用自訂域名（如果已配置）

1. 訪問 `https://your-domain.com`
2. 確認看到首頁內容
3. 檢查 URL 是否正確

### 1.3 檢查 SSL 證書

#### 在瀏覽器中

1. 訪問您的網站
2. 在地址欄點擊鎖形圖標
3. 點擊「Certificate」或「Connection is secure」
4. 驗證以下信息：
   - **Issuer**：應該是 Cloudflare 或 Let's Encrypt
   - **Valid from**：應該是最近的日期
   - **Valid until**：應該是未來的日期

#### 使用在線工具

1. 訪問 `https://www.sslshopper.com/ssl-checker.html`
2. 輸入您的域名
3. 點擊「Check SSL Certificate」
4. 確認 SSL 證書有效

---

## 功能測試

### 2.1 導航測試

#### 測試主導航菜單

| 菜單項 | 預期結果 | 測試方法 |
|--------|---------|---------|
| **首頁** | 返回首頁 | 點擊「首頁」鏈接 |
| **最新消息** | 進入最新消息頁面 | 點擊「最新消息」鏈接 |
| **小組生活** | 進入小組生活頁面 | 點擊「小組生活」鏈接 |
| **新朋友專區** | 進入新朋友專區 | 點擊「新朋友專區」鏈接 |
| **聯絡我們** | 進入聯絡頁面 | 點擊「聯絡我們」鏈接 |

#### 測試步驟

1. 打開網站首頁
2. 逐個點擊每個菜單項
3. 確認頁面正確加載
4. 檢查 URL 是否正確變更
5. 確認沒有 404 錯誤

### 2.2 表單測試

#### 代禱事項表單

1. 進入最新消息頁面
2. 找到「代禱事項」表單
3. 填寫以下信息：
   - 名稱：`測試用戶`
   - 電子郵件：`test@example.com`
   - 代禱事項：`這是一個測試代禱`
4. 點擊「提交」
5. 確認看到成功提示信息
6. 檢查資料庫中是否有新記錄

#### 活動報名表單

1. 進入最新消息頁面
2. 找到「我要報名」表單
3. 填寫以下信息：
   - 名稱：`測試用戶`
   - 電子郵件：`test@example.com`
   - 電話：`0912345678`
   - 活動名稱：`主日聚會`
4. 點擊「報名」
5. 確認看到成功提示信息
6. 檢查資料庫中是否有新記錄

#### 表單驗證測試

1. 嘗試提交空表單
2. 確認看到錯誤提示
3. 嘗試輸入無效的電子郵件
4. 確認看到驗證錯誤提示

### 2.3 後台管理測試

#### 訪問後台

1. 訪問 `https://your-domain.com/admin/news`
2. 確認要求登入
3. 使用您的 Manus 帳號登入
4. 確認進入後台管理頁面

#### 測試新聞管理

1. 點擊「新增新聞」按鈕
2. 填寫以下信息：
   - 標題：`測試新聞`
   - 內容：`這是一個測試新聞`
   - 狀態：`已發佈`
3. 點擊「發佈」
4. 確認新聞出現在列表中
5. 點擊編輯按鈕
6. 修改內容
7. 點擊「保存」
8. 確認修改已保存
9. 點擊刪除按鈕
10. 確認新聞已刪除

#### 測試富文本編輯器

1. 在新聞編輯器中輸入文本
2. 測試以下格式化功能：
   - **粗體**：選擇文本，點擊粗體按鈕
   - *斜體*：選擇文本，點擊斜體按鈕
   - 標題：使用標題下拉菜單
   - 項目符號：點擊列表按鈕
3. 確認格式化正確應用

#### 測試圖片上傳

1. 在新聞編輯器中點擊圖片按鈕
2. 選擇一個本地圖片文件
3. 確認圖片上傳到 S3
4. 確認圖片在編輯器中顯示
5. 發佈新聞
6. 確認圖片在前台正確顯示

### 2.4 頁面內容測試

#### 首頁測試

- [ ] 英雄部分（Hero Section）正確顯示
- [ ] 快速導航卡片可點擊
- [ ] Facebook 社群卡片正確顯示
- [ ] 小組生活區塊正確顯示
- [ ] 線上奉獻區塊正確顯示
- [ ] 交通資訊區塊正確顯示
- [ ] 地圖正確加載和互動
- [ ] 頁尾信息正確顯示

#### 最新消息頁面測試

- [ ] 新聞卡片正確顯示
- [ ] 新聞圖片正確加載
- [ ] 代禱事項區塊正確顯示
- [ ] 活動報名表單正確顯示
- [ ] 電子報訂閱區塊正確顯示

#### 小組生活頁面測試

- [ ] 小組介紹正確顯示
- [ ] 小組聚會時間表正確顯示
- [ ] 聯絡信息正確顯示

#### 新朋友專區測試

- [ ] 聚會流程正確顯示
- [ ] 交通資訊正確顯示
- [ ] 線上奉獻區塊正確顯示

---

## 性能測試

### 3.1 頁面加載速度

#### 使用 Google PageSpeed Insights

1. 訪問 `https://pagespeed.web.dev`
2. 輸入您的域名
3. 點擊「Analyze」
4. 檢查以下指標：

| 指標 | 目標 | 說明 |
|------|------|------|
| **Largest Contentful Paint (LCP)** | < 2.5s | 最大內容元素加載時間 |
| **First Input Delay (FID)** | < 100ms | 首次輸入延遲 |
| **Cumulative Layout Shift (CLS)** | < 0.1 | 累積布局偏移 |

#### 使用 WebPageTest

1. 訪問 `https://www.webpagetest.org`
2. 輸入您的域名
3. 點擊「Start Test」
4. 等待測試完成
5. 查看詳細的性能報告

### 3.2 圖片優化

- [ ] 所有圖片都已壓縮
- [ ] 使用了適當的圖片格式（WebP、JPEG、PNG）
- [ ] 圖片尺寸適應不同設備
- [ ] 沒有過大的圖片文件

### 3.3 代碼優化

- [ ] JavaScript 已最小化
- [ ] CSS 已最小化
- [ ] 沒有未使用的代碼
- [ ] 第三方腳本已優化

---

## 安全檢查

### 4.1 HTTPS 驗證

- [ ] 所有頁面都使用 HTTPS
- [ ] 沒有混合內容警告
- [ ] SSL 證書有效

### 4.2 安全頭檢查

#### 使用在線工具

1. 訪問 `https://securityheaders.com`
2. 輸入您的域名
3. 點擊「Scan」
4. 檢查安全頭配置

#### 應該配置的安全頭

| 頭名稱 | 說明 |
|--------|------|
| **Content-Security-Policy** | 防止 XSS 攻擊 |
| **X-Content-Type-Options** | 防止 MIME 類型嗅探 |
| **X-Frame-Options** | 防止點擊劫持 |
| **Strict-Transport-Security** | 強制使用 HTTPS |

### 4.3 敏感信息檢查

- [ ] 沒有在前端代碼中暴露 API 密鑰
- [ ] 沒有在 HTML 中硬編碼密碼
- [ ] 環境變數正確存儲在 Cloudflare 中
- [ ] `.env` 文件不在 Git 倉庫中

### 4.4 依賴安全檢查

1. 在 GitHub Repository 中
2. 點擊「Security」標籤
3. 檢查「Dependabot alerts」
4. 更新任何有安全漏洞的依賴

---

## 監控和維護

### 5.1 設置 Cloudflare Analytics

1. 在 Cloudflare Pages 中
2. 點擊「Analytics」標籤
3. 查看以下指標：
   - 請求數量
   - 帶寬使用量
   - 錯誤率
   - 訪問地理分佈

### 5.2 設置 Google Analytics

1. 在 `client/index.html` 中添加 Google Analytics 代碼：
   ```html
   <!-- Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
     gtag('config', 'G-XXXXXXXXXX');
   </script>
   ```
2. 將 `G-XXXXXXXXXX` 替換為您的 Google Analytics ID
3. 訪問 `https://analytics.google.com` 查看詳細分析

### 5.3 設置錯誤監控

1. 考慮使用 Sentry 或類似服務
2. 在應用程序中集成錯誤追蹤
3. 定期檢查錯誤報告

### 5.4 定期備份

1. 定期備份資料庫
2. 定期備份 GitHub Repository
3. 保留至少 30 天的備份歷史

---

## 故障排除

### 問題 1：頁面無法加載

**症狀：** 訪問網站時看到 404 或 500 錯誤

**解決方案：**

1. 檢查部署狀態
   - 在 Cloudflare Pages 中查看最新部署是否成功

2. 檢查構建日誌
   - 查看「Build log」中是否有錯誤信息

3. 清除緩存
   - 按下 `Ctrl+Shift+Delete` 清除瀏覽器緩存
   - 重新訪問網站

4. 檢查 DNS
   - 使用 `nslookup` 或 `dig` 命令檢查 DNS 解析

### 問題 2：表單提交失敗

**症狀：** 提交表單時看到錯誤信息

**解決方案：**

1. 檢查環境變數
   - 確保所有必需的環境變數都已設置
   - 檢查變數值是否正確

2. 檢查資料庫連接
   - 確保 `DATABASE_URL` 正確
   - 測試資料庫連接

3. 查看控制台錯誤
   - 打開開發者工具（F12）
   - 查看「Console」標籤中的錯誤信息

4. 檢查網絡請求
   - 在「Network」標籤中查看 API 請求
   - 檢查請求狀態碼和響應內容

### 問題 3：後台管理無法訪問

**症狀：** 無法登入後台管理頁面

**解決方案：**

1. 檢查登入 URL
   - 確保使用正確的登入 URL
   - 確保 OAuth 配置正確

2. 檢查環境變數
   - 確保 `VITE_APP_ID` 和 `OAUTH_SERVER_URL` 正確

3. 清除 Cookie
   - 清除瀏覽器 Cookie
   - 重新登入

4. 檢查用戶權限
   - 確保您的帳號有管理員權限

### 問題 4：圖片無法加載

**症狀：** 圖片顯示為損壞的圖標

**解決方案：**

1. 檢查圖片 URL
   - 確保圖片 URL 正確
   - 確保圖片在 S3 中存在

2. 檢查 S3 權限
   - 確保 S3 bucket 是公開的
   - 確保圖片文件有正確的權限

3. 檢查 CORS 設置
   - 確保 S3 CORS 配置正確

4. 檢查圖片格式
   - 確保圖片格式支持（JPEG、PNG、WebP）

### 問題 5：性能緩慢

**症狀：** 網站加載速度很慢

**解決方案：**

1. 優化圖片
   - 壓縮圖片文件
   - 使用適當的圖片格式

2. 啟用緩存
   - 確保 Cloudflare 緩存已啟用
   - 設置適當的緩存過期時間

3. 優化代碼
   - 移除未使用的代碼
   - 最小化 JavaScript 和 CSS

4. 檢查第三方腳本
   - 移除不必要的第三方腳本
   - 延遲加載非關鍵腳本

---

## 測試檢查清單

在宣布網站上線前，請確認以下項目：

### 基本功能
- [ ] 首頁正確加載
- [ ] 所有導航鏈接正常工作
- [ ] 所有表單可以提交
- [ ] 後台管理可以訪問

### 內容
- [ ] 所有文本正確顯示
- [ ] 所有圖片正確加載
- [ ] 所有視頻正確播放
- [ ] 沒有拼寫或語法錯誤

### 技術
- [ ] HTTPS 正常工作
- [ ] SSL 證書有效
- [ ] 沒有控制台錯誤
- [ ] 沒有網絡錯誤

### 性能
- [ ] 頁面加載速度快
- [ ] 圖片已優化
- [ ] 代碼已最小化
- [ ] 沒有性能瓶頸

### 安全
- [ ] 敏感信息已隱藏
- [ ] 環境變數正確配置
- [ ] 依賴已更新
- [ ] 沒有安全漏洞

### 跨瀏覽器
- [ ] Chrome 正常工作
- [ ] Firefox 正常工作
- [ ] Safari 正常工作
- [ ] Edge 正常工作

### 響應式設計
- [ ] 桌面版本正常顯示
- [ ] 平板版本正常顯示
- [ ] 手機版本正常顯示
- [ ] 所有元素都可點擊

---

## 總結

✅ 您已經完成了：
1. 部署完成檢查
2. 功能測試
3. 性能測試
4. 安全檢查
5. 監控和維護設置

🎉 您的網站現在已經準備好為訪客服務了！

---

## 需要幫助？

如果您遇到問題：
1. 查看本指南的故障排除部分
2. 檢查 Cloudflare 官方文檔
3. 查看應用程序日誌
4. 聯絡技術支持

祝您使用愉快！🚀
